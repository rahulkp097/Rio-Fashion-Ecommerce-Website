<!DOCTYPE html>

<!-- =========================================================
* Sneat - Bootstrap 5 HTML Admin Template - Pro | v1.0.0
==============================================================

* Product Page: https://themeselection.com/products/sneat-bootstrap-html-admin-template/
* Created by: ThemeSelection
* License: You must have a valid license purchased in order to legally use the theme for your project.
* Copyright ThemeSelection (https://themeselection.com)

=========================================================
 -->
<!-- beautify ignore:start -->
<html
  lang="en"
  class="light-style layout-menu-fixed"
  dir="ltr"
  data-theme="theme-default"
  data-assets-path="../assets/"
  data-template="vertical-menu-template-free"
>
  <head>
    <meta charset="utf-8" />
    <meta
      name="viewport"
      content="width=device-width, initial-scale=1.0, user-scalable=no, minimum-scale=1.0, maximum-scale=1.0"
    />

    <title>Rio-Fashion</title>

    <meta name="description" content="" />

    <!-- Favicon -->
    <link rel="icon" type="image/x-icon" href="/assets/img/favicon/favicon.ico">

    <!-- Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=Public+Sans:ital,wght@0,300;0,400;0,500;0,600;0,700;1,300;1,400;1,500;1,600;1,700&display=swap"
      rel="stylesheet"
    />
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.10.0/css/all.min.css" rel="stylesheet">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.4.1/font/bootstrap-icons.css" rel="stylesheet">
    <!-- Icons. Uncomment required icon fonts -->
    <link rel="stylesheet" href="/assets/vendor/fonts/boxicons.css" />

    <!-- Core CSS -->
    <link rel="stylesheet" href="/assets/vendor/css/core.css" class="template-customizer-core-css" />
    <link rel="stylesheet" href="/assets/vendor/css/theme-default.css" class="template-customizer-theme-css" />
    <link rel="stylesheet" href="/assets/css/demo.css" />

    <!-- Vendors CSS -->
    <link rel="stylesheet" href="/assets/vendor/libs/perfect-scrollbar/perfect-scrollbar.css" />

    <link rel="stylesheet" href="/assets/vendor/libs/apex-charts/apex-charts.css" />

    <!-- Page CSS -->

    <!-- Helpers -->
    <script src="/assets/vendor/js/helpers.js"></script>

    <!--! Template customizer & Theme config files MUST be included after core stylesheets and helpers.js in the <head> section -->
    <!--? Config:  Mandatory theme config file contain global vars & default theme options, Set your preferred theme option in this file.  -->
    <script src="/assets/js/config.js"></script>
  </head>

  <style>
    /* Add your custom styles here */
    body {
        font-family: 'Public Sans', sans-serif;
        background-color: #f8f9fa;
        color: #333;
    }
    h1 {
        margin-top: 40px;
        margin-bottom: 20px;
        font-size: 24px;
    }
 
    label {
        display: block;
        margin-bottom: 10px;
        font-weight: bold;
    }
    input[type="text"],
    input[type="number"],
    input[type="tel"],
    select {
        width: 100%;
        padding: 10px;
        border: 1px solid #ccc;
        border-radius: 4px;
        box-sizing: border-box;
    }
    button[type="submit"] {
        display: block;
        width: 100%;
        padding: 10px;
        margin-top: 20px;
        background-color: #007bff;
        color: #fff;
        border: none;
        border-radius: 4px;
        cursor: pointer;
    }
</style>

  <body>
    <!-- Layout wrapper -->
    <div class="layout-wrapper layout-content-navbar">
      <div class="layout-container">
        <!-- Menu -->

          <!-- Include the sidebar partial -->
<aside id="layout-menu" class="layout-menu menu-vertical menu bg-menu-theme">
  <%- include('../admin/partials/sidebar.ejs') %>
</aside>

        <!-- Layout container -->
        <div class="layout-page">
          <!-- Navbar -->

          <nav class="layout-navbar container-xxl navbar navbar-expand-xl navbar-detached align-items-center bg-navbar-theme" id="layout-navbar">
            <%- include('../admin/partials/navbar.ejs') %>
          </nav>
          <!-- / Navbar -->


               <!-- /dashboard start -->
                <div class="container-xxl flex-grow-1 container-p-y">
               <form id="editProductForm" action="/admin/product/updateproduct" method="POST" enctype="multipart/form-data" onsubmit="return validateEditForm()">
                <input type="hidden" name="productId" value="<%= product._id %>">
                
                <div>
                    <label for="category">Category:</label>
                    <select name="category" required  id="categoryName" onchange="toggleSizeField()">
                        <% categories.forEach(function(category) { %>
                            <option value="<%= category._id %>" <%= product.category === category._id ? 'selected' : '' %>><%= category.name %></option>
                        <% }) %>
                    </select>
                </div>

                <div class="mb-3" id="sizeField">
                  <label for="categorySize" class="form-label">Size</label>
                  <select name="size" class="form-control" id="categorySize">
                    <option value="S">Small</option>
                    <option value="M">Medium</option>
                    <option value="L">Large</option>
                    <!-- Add more size options if needed -->
                  </select>
                </div>

                <div>
                  <label for="title">Title:</label>
                  <input type="text" name="title" value="<%= product.title %>" >
                  <span id="title-error" class="error"></span>
              </div>

                <div>
                    <label for="brand">Brand:</label>
                    <input type="text" name="brand" value="<%= product.brand %>" >
                    <span id="brand-error" class="error"></span>
                </div>
                <div>
                    <label for="description">Description:</label>
                    <input type="text" name="description" value="<%= product.description %>" >
                    <span id="description-error" class="error"></span>
                </div>
                <div>
                    <label for="quantity">Quantity:</label>
                    <input type="number" name="quantity" value="<%= product.quantity %>" >
                    <span id="quantity-error" class="error"></span>
                </div>
                <div>
                    <label for="sellingPrice">Selling Price:</label>
                    <input type="tel" name="sellingprice" value="<%= product.sellingprice %>" >
                    <span id="sellingprice-error" class="error"></span>
                </div>
                <div>
                    <label for="offerPrice">Offer Price:</label>
                    <input type="tel" name="offerprice" value="<%= product.offerprice %>" >
                    <span id="offerprice-error" class="error"></span>
                </div>
               


                <div class="row mb-3">
                 
                  <div class="col-sm-10">
                    <div class="image-container">
                      <% product.image.forEach(function(image, index) { %>
                        <img src="<%= '/images/' + image %>" alt="preview image" width="100px">
                        <a onclick="removeimage('<%= product._id %>','<%= index %>')"><i
                            class="bi bi-x-octagon-fill text-danger"></i></a>
                        <% }) %>
                    </div>
                  </div>
                </div>
                <div class="row mb-3">
                  
                  <div class="col-sm-10">
                    <input type="file" name="image[]" class="form-control" id="inputPassword3" accept="image/*" multiple >
    
                    <input type="hidden" name="product._id" value="<%= product._id %>" class="form-control" id="inputPassword3">
                  </div>
                </div>
    




                <button type="submit">Update Product</button>
            </form>

          </div>
            <!-- / Content -->

            <!-- Footer -->
            <footer class="content-footer footer bg-footer-theme">
              <div class="container-xxl d-flex flex-wrap justify-content-between py-2 flex-md-row flex-column">
            
             
              </div>
            </footer>
            <!-- / Footer -->

            <div class="content-backdrop fade"></div>
          </div>
          <!-- Content wrapper -->
        </div>
        <!-- / Layout page -->
      </div>

      <!-- Overlay -->
      <div class="layout-overlay layout-menu-toggle"></div>
    </div>
    <!-- / Layout wrapper -->

    <!-- Core JS -->
    <!-- build:js assets/vendor/js/core.js -->
    <script src="/assets/vendor/libs/jquery/jquery.js"></script>
    <script src="/assets/vendor/libs/popper/popper.js"></script>
    <script src="/assets/vendor/js/bootstrap.js"></script>
    <script src="/assets/vendor/libs/perfect-scrollbar/perfect-scrollbar.js"></script>

    <script src="/assets/vendor/js/menu.js"></script>
    <!-- endbuild -->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>

    <!-- Vendors JS -->
    <script src="/assets/vendor/libs/apex-charts/apexcharts.js"></script>

    <!-- Main JS -->
    <script src="/assets/js/main.js"></script>

    <!-- Page JS -->
    <script src="/assets/js/dashboards-analytics.js"></script>

    <!-- Place this tag in your head or just before your close body tag. -->
    <script async defer src="https://buttons.github.io/buttons.js"></script>
    
<script>
  function validateEditForm() {
      var title = document.forms["editProductForm"]["title"].value;
      var brand = document.forms["editProductForm"]["brand"].value;
      var description = document.forms["editProductForm"]["description"].value;
      var quantity = document.forms["editProductForm"]["quantity"].value;
      var sellingPrice = document.forms["editProductForm"]["sellingprice"].value;
      var offerPrice = document.forms["editProductForm"]["offerprice"].value;

      var titleError = document.getElementById("title-error");
      var brandError = document.getElementById("brand-error");
      var descriptionError = document.getElementById("description-error");
      var quantityError = document.getElementById("quantity-error");
      var sellingPriceError = document.getElementById("sellingprice-error");
      var offerPriceError = document.getElementById("offerprice-error");

      titleError.textContent = "";
      brandError.textContent = "";
      descriptionError.textContent = "";
      quantityError.textContent = "";
      sellingPriceError.textContent = "";
      offerPriceError.textContent = "";

      if (title.trim() === "") {
          titleError.textContent = "Please enter the title.";
          return false;
      }

      if (brand.trim() === "") {
          brandError.textContent = "Please enter the brand.";
          return false;
      }

      if (description.trim() === "") {
          descriptionError.textContent = "Please enter the description.";
          return false;
      }

      if (quantity.trim() === "") {
          quantityError.textContent = "Please enter the quantity.";
          return false;
      }
      if (sellingPrice.trim() === "") {
sellingPriceError.textContent = "Please enter the selling price.";
return false;
} else if (isNaN(parseFloat(sellingPrice)) || parseFloat(sellingPrice) <= 0) {
sellingPriceError.textContent = "Please enter a valid positive selling price.";
return false;
}

if (offerPrice.trim() === "") {
offerPriceError.textContent = "Please enter the offer price.";
return false;
} else if (isNaN(parseFloat(offerPrice)) || parseFloat(offerPrice) <= 0) {
offerPriceError.textContent = "Please enter a valid positive offer price.";
return false;
}
  }
</script>

<script>
function toggleSizeField() {
  const categorySelect = document.getElementById('categoryName');
  const sizeField = document.getElementById('sizeField');
console.log
  // Get the selected option value (category ID)
  const selectedCategoryId = categorySelect.value;

  // Get the option element for the selected category
  const selectedCategoryOption = categorySelect.querySelector(`option[value="${selectedCategoryId}"]`);

  // Check if the selected category is "Accessories" and hide the size field
  if (selectedCategoryOption.innerText === 'Accessories') {
    sizeField.style.display = 'none';
  } else {
    sizeField.style.display = 'block';
  }
}
</script>

<script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.3/jquery.min.js"></script>

<script>
function removeimage(id, position) {
  $.ajax({
    url: '/admin/product/removeProductImage',
    method: 'post',
    data: {
      id: id,
      position: position
    },
    success: (response) => {
      if (response) {
        window.location.reload()
      }
    }

  })
 }


    </script>



  </body>
</html>
